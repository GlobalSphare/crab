"use strict";(self.webpackChunkisland_install_front=self.webpackChunkisland_install_front||[]).push([[21,911],{6031:(e,t,a)=>{a(5671),a(3144),a(7326),a(136),a(2963),a(1120);a(7294).Component},5597:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(5671),i=a(3144),r=a(7326),o=a(136),c=a(2963),l=a(1120),s=a(7294),u=a(4981);a(2477),a(6588);var h=function(e){(0,o.Z)(d,e);var t,a,h=(t=d,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,l.Z)(t);if(a){var i=(0,l.Z)(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function d(e){var t;return(0,n.Z)(this,d),(t=h.call(this,e)).state={value:"",height:19,cursorStyle:"ace-cursor"},t.change=t.change.bind((0,r.Z)(t)),t.focus=t.focus.bind((0,r.Z)(t)),t.blur=t.blur.bind((0,r.Z)(t)),t.lineHeight=0,t.propsHeight=19,t}return(0,i.Z)(d,[{key:"focus",value:function(){this.setState({cursorStyle:""})}},{key:"blur",value:function(){this.setState({cursorStyle:"ace-cursor"})}},{key:"change",value:function(e){var t=this;this.setState({value:e},(function(){t.resize()}))}},{key:"getData",value:function(){return this.state.value}},{key:"setData",value:function(e){var t=this;this.setState({value:e},(function(){t.resize()}))}},{key:"setHeight",value:function(e){this.propsHeight=e,this.setState({height:e})}},{key:"resize",value:function(){this.lineHeight||(this.lineHeight=parseInt(getComputedStyle(document.querySelector(".ace_line")).lineHeight.replace("px","")));var e=this.state.value.split("\n").length;e*this.lineHeight>this.propsHeight?this.setState({height:e*this.lineHeight}):this.setState({height:this.propsHeight})}},{key:"aceLoaded",value:function(e){e.renderer.setPadding(0)}},{key:"render",value:function(){return s.createElement(u.ZP,{mode:"yaml",theme:"xcode",width:"100%",height:this.state.height+"px",style:{margin:0},placeholder:"请输入...",fontSize:14,tabSize:2,value:this.state.value,onLoad:this.aceLoaded,onChange:this.change,name:this.props.uniqueName,showGutter:!1,showPrintMargin:!1,highlightActiveLine:!1,onFocus:this.focus,onBlur:this.blur,editorProps:{$blockScrolling:!0}})}}]),d}(s.Component)},517:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(8390),i=a(7294),r=a(4494),o=a(282),c=a(9669),l=a.n(c),s=a(3411),u=a(5347),h=a(9678),d=a(6105),p=(a(6031),a(5597));const f=(0,r.$j)((function(e){return e}))((function(e){var t=(0,i.useRef)(null),a=(0,i.useRef)(null),r=(0,i.useState)(!1),c=(0,n.Z)(r,2),f=c[0],v=c[1],m=(0,i.useState)(""),g=(0,n.Z)(m,2),y=g[0],Z=g[1],S=(0,i.useState)(null),b=(0,n.Z)(S,2),w=b[0],k=b[1];(0,i.useEffect)((function(){var e=function(){var e="";if(window.location.search){var t=window.location.search.substring(1);if(t.indexOf("&"))for(var a=t.split("&"),n=0,i=a.length;n<i;n++){var r=a[n].split("=");if(r&&"name"===r[0]){e=r[1];break}}}return e}();t.current.setHeight(parseInt(getComputedStyle(a.current).height.replace("px",""))),e?(Z(e),E(e)):t.current.setData('apiVersion: aam.globalsphare.com/v1alpha1\nkind: Trait\nmetadata:\n  name: expose\nspec:\n  parameter: |\n    k1: *"v1" | string')}),[]);var E=function(e){s.Z.dispatch({type:u.br,val:!0}),l()({method:"GET",url:"/api/online/gettrait",params:{name:e}}).then((function(e){0==e.data.code?(k(e.data.result||{}),t.current.setData(e.data.result.value||"")):s.Z.dispatch({type:u.Sn,val:e.data.result})})).catch((function(e){console.log(e),s.Z.dispatch({type:u.Sn,val:"请求错误"})})).finally((function(){s.Z.dispatch({type:u.br,val:!1})}))};return i.createElement("section",{className:"online-container"},i.createElement("header",{className:"online-header"},i.createElement("div",{className:"header-logo"},"Crab")),i.createElement("div",{className:"online-content"},i.createElement("div",{className:"oltitle"},y?"修改":"创建"," Trait ",y?" : "+y:""),i.createElement("section",{className:"trait-content"},i.createElement("div",{className:"trait-textarea",ref:a},i.createElement(p.Z,{ref:t,uniqueName:"autoTxRef"})),i.createElement("div",{className:"online-btns"},y?i.createElement(o.Z,{disabled:f,className:"online-btn",variant:"contained",color:"primary",onClick:function(){s.Z.dispatch({type:u.br,val:!0}),v(!0);var e="/api/cluster/edittrait?id=".concat(w.id||"");l()({url:e,method:"POST",headers:{"Content-Type":"application/json"},data:{value:t.current.getData()}}).then((function(e){0==e.data.code?setTimeout((function(){v(!1),window.opener.postMessage("trait",window.location.origin),window.close()}),1e3):v(!1),s.Z.dispatch({type:u.Sn,val:e.data.result||""})})).catch((function(e){console.error(e),v(!1),s.Z.dispatch({type:u.Sn,val:"请求错误"})})).finally((function(){s.Z.dispatch({type:u.br,val:!1})}))}},"确认修改"):i.createElement(o.Z,{disabled:f,className:"online-btn",variant:"contained",color:"primary",onClick:function(){if(""!==t.current.getData().trim()||(s.Z.dispatch({type:u.Sn,val:"请输入trait内容"}),0)){s.Z.dispatch({type:u.br,val:!0}),v(!0);var e=t.current.getData();l()({method:"POST",url:"/api/online/createtrait",data:{value:e},headers:{"Content-Type":"application/json"}}).then((function(e){s.Z.dispatch({type:u.Sn,val:e.data.result}),0==e.data.code?setTimeout((function(){v(!1),window.opener.postMessage("trait",window.location.origin),window.close()}),1e3):v(!1)})).catch((function(e){console.log(e),v(!1),s.Z.dispatch({type:u.Sn,val:"请求错误"})})).finally((function(){s.Z.dispatch({type:u.br,val:!1})}))}}},"保存")))),i.createElement(h.Z,null),i.createElement(d.Z,null))}))}}]);